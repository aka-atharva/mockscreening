(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{8126:(e,s,t)=>{Promise.resolve().then(t.bind(t,6943))},6943:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>eN});var a=t(5155),r=t(425),i=t(4110),n=t(2115),l=t(8888),o=t(6062),d=t(2823),c=t(6745),m=t(2640),u=t(8236),x=t(1069),h=t(6046);async function p(){try{let e="http://localhost:8080/api",s=localStorage.getItem("token"),t={Authorization:"Bearer ".concat(s),Accept:"application/json","Content-Type":"application/json"},a=await fetch("".concat(e,"/admin/stats"),{headers:t}),r=await fetch("".concat(e,"/admin/users"),{headers:t}),i=[];try{let s=new Date().getTime(),a=await fetch("".concat(e,"/admin/activity?limit=50&_t=").concat(s),{headers:t});if(!a.ok)throw Error("Failed to fetch activity logs: ".concat(a.statusText));i=(i=await a.json()).map(e=>({...e,timestamp:e.timestamp?new Date(e.timestamp).toISOString():new Date().toISOString()}))}catch(e){console.error("Error fetching activity logs:",e),i=[{id:1,action:"User login",username:"system",timestamp:new Date().toISOString(),details:"Activity log system initialized with fallback data"}]}let n=await fetch("".concat(e,"/admin/settings"),{headers:t});if(!a.ok||!r.ok||!n.ok)throw Error("Failed to fetch admin data");let l=await a.json(),o=await r.json(),d=await n.json();return{stats:l,users:o,activity:i,systemSettings:d}}catch(e){return console.error("Error fetching admin data:",e),{stats:{total_users:42,active_users:38,researchers:15,regular_users:26,system_uptime:"3 days, 7 hours",database_size:"42.5 MB"},users:[{id:1,username:"admin",email:"admin@example.com",role:"admin",is_active:!0,created_at:"2023-01-01T00:00:00"},{id:2,username:"researcher",email:"researcher@example.com",role:"researcher",is_active:!0,created_at:"2023-01-02T00:00:00"},{id:3,username:"user",email:"user@example.com",role:"user",is_active:!0,created_at:"2023-01-03T00:00:00"}],activity:[{id:1,action:"User login",username:"researcher",timestamp:new Date().toISOString(),details:"Successful login"},{id:2,action:"Data export",username:"researcher",timestamp:new Date(Date.now()-9e5).toISOString(),details:"Exported 1,245 records"},{id:3,action:"Failed login attempt",username:"unknown",timestamp:new Date(Date.now()-18e5).toISOString(),details:"Invalid credentials"}],systemSettings:{maintenance_mode:!1,debug_mode:!0,api_rate_limiting:!0,last_backup:new Date(Date.now()-864e5).toISOString()}}}}async function g(e,s){let t=localStorage.getItem("token"),a=await fetch("".concat("http://localhost:8080/api","/admin/settings"),{method:"PUT",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({[e]:s})});if(!a.ok)throw Error("Failed to update setting");return await a.json()}async function f(){let e=localStorage.getItem("token");if(!(await fetch("".concat("http://localhost:8080/api","/admin/backup"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}})).ok)throw Error("Failed to start backup");return{message:"Backup process started"}}async function b(){let e=localStorage.getItem("token");if(!(await fetch("".concat("http://localhost:8080/api","/admin/export-data"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}})).ok)throw Error("Failed to export data");return{message:"Data export initiated"}}async function j(){let e=localStorage.getItem("token");if(!(await fetch("".concat("http://localhost:8080/api","/admin/cleanup-data"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}})).ok)throw Error("Failed to clean up data");return{message:"Data cleanup process started"}}async function v(e,s){let t=localStorage.getItem("token"),a=await fetch("".concat("http://localhost:8080/api","/admin/users/").concat(e),{method:"PUT",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw Error((await a.json()).detail||"Failed to update user");return await a.json()}async function y(e){let s=localStorage.getItem("token"),t=await fetch("".concat("http://localhost:8080/api","/admin/users/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(s)}});if(!t.ok)throw Error((await t.json()).detail||"Failed to delete user");return null}async function N(e){let s=localStorage.getItem("token"),t=await fetch("".concat("http://localhost:8080/api","/admin/users"),{method:"POST",headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json()).detail||"Failed to create user");return await t.json()}async function w(e){let s=localStorage.getItem("token");if(!(await fetch("".concat("http://localhost:8080/api","/admin/activity/clear?days=").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"}})).ok)throw Error("Failed to clear activity logs");return{message:"Activity logs cleared successfully"}}var k=t(5472);let C=(0,t(9827).v)(e=>({loading:!0,setLoading:s=>e({loading:s}),error:null,setError:s=>e({error:s}),notification:null,setNotification:s=>e({notification:s}),stats:null,setStats:s=>e({stats:s}),users:[],setUsers:s=>e({users:s}),activity:[],setActivity:s=>e({activity:s}),systemSettings:null,setSystemSettings:s=>e({systemSettings:s}),roles:[{id:1,name:"admin",description:"Full access to all system features and settings.",permissions:["user_management","system_settings","data_management","activity_logs"]},{id:2,name:"researcher",description:"Access to research tools and data analysis features.",permissions:["datapuur","kginsights","data_management"]},{id:3,name:"user",description:"Basic access to application features.",permissions:["view_reports","personal_settings"]}],setRoles:s=>e({roles:s}),availablePermissions:[{id:"user_management",name:"User Management"},{id:"system_settings",name:"System Settings"},{id:"data_management",name:"Data Management"},{id:"activity_logs",name:"Activity Logs"},{id:"datapuur",name:"DataPuur Access"},{id:"kginsights",name:"KGInsights Access"},{id:"view_reports",name:"View Reports"},{id:"personal_settings",name:"Personal Settings"}],setAvailablePermissions:s=>e({availablePermissions:s}),isProcessing:!1,setIsProcessing:s=>e({isProcessing:s})}));function S(){let{stats:e,activity:s}=C();return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-foreground mb-4",children:"System Overview"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"bg-card p-6 rounded-lg border border-border",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-card-foreground mb-2",children:"User Statistics"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Total Users:"}),(0,a.jsx)("span",{className:"text-card-foreground font-medium",children:null==e?void 0:e.total_users})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Active Users:"}),(0,a.jsx)("span",{className:"text-card-foreground font-medium",children:null==e?void 0:e.active_users})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Researchers:"}),(0,a.jsx)("span",{className:"text-card-foreground font-medium",children:null==e?void 0:e.researchers})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Regular Users:"}),(0,a.jsx)("span",{className:"text-card-foreground font-medium",children:null==e?void 0:e.regular_users})]})]})]}),(0,a.jsxs)("div",{className:"bg-card p-6 rounded-lg border border-border",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-card-foreground mb-2",children:"System Status"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Uptime:"}),(0,a.jsx)("span",{className:"text-card-foreground font-medium",children:null==e?void 0:e.system_uptime})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Database Size:"}),(0,a.jsx)("span",{className:"text-card-foreground font-medium",children:null==e?void 0:e.database_size})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Status:"}),(0,a.jsx)("span",{className:"text-violet-500 font-medium",children:"Operational"})]})]})]}),(0,a.jsxs)("div",{className:"bg-card p-6 rounded-lg border border-border",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-card-foreground mb-2",children:"Recent Activity"}),(0,a.jsx)("div",{className:"space-y-2",children:null==s?void 0:s.slice(0,3).map(e=>(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("div",{className:"text-card-foreground",children:e.action}),(0,a.jsxs)("div",{className:"text-muted-foreground text-xs",children:[new Date(e.timestamp).toLocaleString()," - ",e.username]})]},e.id))})]})]})]})}var A=t(7517),_=t(4085),E=t(1773),F=t(6217),T=t(767),D=t(9602);let R=F.bL;F.l9;let I=F.ZL;F.bm;let U=n.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(F.hJ,{ref:s,className:(0,D.cn)("fixed inset-0 z-50 bg-black/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r})});U.displayName=F.hJ.displayName;let O=n.forwardRef((e,s)=>{let{className:t,children:r,...i}=e;return(0,a.jsxs)(I,{children:[(0,a.jsx)(U,{}),(0,a.jsxs)(F.UC,{ref:s,className:(0,D.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...i,children:[r,(0,a.jsxs)(F.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(T.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});O.displayName=F.UC.displayName;let P=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,D.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s),...t})};P.displayName="DialogHeader";let z=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,D.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};z.displayName="DialogFooter";let L=n.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(F.hE,{ref:s,className:(0,D.cn)("text-lg font-semibold leading-none tracking-tight",t),...r})});L.displayName=F.hE.displayName,n.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(F.VY,{ref:s,className:(0,D.cn)("text-sm text-muted-foreground",t),...r})}).displayName=F.VY.displayName;var $=t(2336),M=t(6195);let B=(0,t(6421).F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),q=n.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(M.b,{ref:s,className:(0,D.cn)(B(),t),...r})});q.displayName=M.b.displayName;var J=t(2413);let V=n.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(J.bL,{className:(0,D.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...r,ref:s,children:(0,a.jsx)(J.zi,{className:(0,D.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});V.displayName=J.bL.displayName;var Y=t(127),W=t(1719),Z=t(1902),G=t(8867);let H=Y.bL;Y.YJ;let K=Y.WT,Q=n.forwardRef((e,s)=>{let{className:t,children:r,...i}=e;return(0,a.jsxs)(Y.l9,{ref:s,className:(0,D.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...i,children:[r,(0,a.jsx)(Y.In,{asChild:!0,children:(0,a.jsx)(W.A,{className:"h-4 w-4 opacity-50"})})]})});Q.displayName=Y.l9.displayName;let X=n.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(Y.PP,{ref:s,className:(0,D.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(Z.A,{className:"h-4 w-4"})})});X.displayName=Y.PP.displayName;let ee=n.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(Y.wn,{ref:s,className:(0,D.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(W.A,{className:"h-4 w-4"})})});ee.displayName=Y.wn.displayName;let es=n.forwardRef((e,s)=>{let{className:t,children:r,position:i="popper",...n}=e;return(0,a.jsx)(Y.ZL,{children:(0,a.jsxs)(Y.UC,{ref:s,className:(0,D.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:i,...n,children:[(0,a.jsx)(X,{}),(0,a.jsx)(Y.LM,{className:(0,D.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(ee,{})]})})});es.displayName=Y.UC.displayName,n.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(Y.JU,{ref:s,className:(0,D.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...r})}).displayName=Y.JU.displayName;let et=n.forwardRef((e,s)=>{let{className:t,children:r,...i}=e;return(0,a.jsxs)(Y.q7,{ref:s,className:(0,D.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...i,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(Y.VF,{children:(0,a.jsx)(G.A,{className:"h-4 w-4"})})}),(0,a.jsx)(Y.p4,{children:r})]})});function ea(e){let{open:s,onOpenChange:t,user:r}=e,{users:i,setUsers:l,isProcessing:o,setIsProcessing:d,setNotification:c}=C(),[m,u]=(0,n.useState)({username:r.username,email:r.email,role:r.role,is_active:r.is_active}),{roles:x}=C(),h=async()=>{d(!0);try{let e=await v(r.id,m);l(i.map(s=>s.id===e.id?e:s)),c({type:"success",message:"User ".concat(e.username," updated successfully")}),t(!1),setTimeout(()=>c(null),3e3)}catch(e){console.error("Error updating user:",e),c({type:"error",message:e.message||"Failed to update user"}),setTimeout(()=>c(null),3e3)}finally{d(!1)}};return(0,a.jsx)(R,{open:s,onOpenChange:t,children:(0,a.jsxs)(O,{className:"bg-card border border-border text-card-foreground",children:[(0,a.jsx)(P,{children:(0,a.jsx)(L,{children:"Edit User"})}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q,{htmlFor:"username",children:"Username"}),(0,a.jsx)($.p,{id:"username",value:m.username,onChange:e=>u({...m,username:e.target.value}),className:"bg-background border-input text-foreground",disabled:"admin"===r.username})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q,{htmlFor:"email",children:"Email"}),(0,a.jsx)($.p,{id:"email",value:m.email,onChange:e=>u({...m,email:e.target.value}),className:"bg-background border-input text-foreground"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q,{htmlFor:"role",children:"Role"}),(0,a.jsxs)(H,{value:m.role,onValueChange:e=>u({...m,role:e}),disabled:"admin"===r.username,children:[(0,a.jsx)(Q,{className:"bg-background border-input text-foreground",children:(0,a.jsx)(K,{placeholder:"Select a role"})}),(0,a.jsx)(es,{className:"bg-popover border border-border text-popover-foreground",children:C.getState().roles.map(e=>(0,a.jsx)(et,{value:e.name,children:e.name},e.id))})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(V,{id:"is_active",checked:m.is_active,onCheckedChange:e=>u({...m,is_active:e}),disabled:"admin"===r.username}),(0,a.jsx)(q,{htmlFor:"is_active",children:"Active"})]})]}),(0,a.jsxs)(z,{children:[(0,a.jsx)(_.$,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),(0,a.jsx)(_.$,{className:"bg-violet-600 hover:bg-violet-700 text-white btn-glow",onClick:h,disabled:o,children:o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(E.A,{className:"h-3 w-3 mr-1 animate-spin text-white"}),"Saving..."]}):"Save Changes"})]})]})})}function er(e){let{open:s,onOpenChange:t,user:r}=e,{users:i,setUsers:n,isProcessing:l,setIsProcessing:o,setNotification:d}=C(),c=async()=>{o(!0);try{await y(r.id),n(i.filter(e=>e.id!==r.id)),d({type:"success",message:"User ".concat(r.username," deleted successfully")}),t(!1),setTimeout(()=>d(null),3e3)}catch(e){console.error("Error deleting user:",e),d({type:"error",message:e.message||"Failed to delete user"}),setTimeout(()=>d(null),3e3)}finally{o(!1)}};return(0,a.jsx)(R,{open:s,onOpenChange:t,children:(0,a.jsxs)(O,{className:"bg-card border border-border text-card-foreground",children:[(0,a.jsx)(P,{children:(0,a.jsx)(L,{children:"Delete User"})}),(0,a.jsxs)("div",{className:"py-4",children:[(0,a.jsxs)("p",{children:["Are you sure you want to delete user ",(0,a.jsx)("strong",{children:r.username}),"?"]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"This action cannot be undone."})]}),(0,a.jsxs)(z,{children:[(0,a.jsx)(_.$,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),(0,a.jsx)(_.$,{className:"bg-destructive hover:bg-destructive/80 text-white",onClick:c,disabled:l,children:l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(E.A,{className:"h-3 w-3 mr-1 animate-spin text-white"}),"Deleting..."]}):"Delete User"})]})]})})}function ei(e){let{open:s,onOpenChange:t}=e,{users:r,setUsers:i,isProcessing:l,setIsProcessing:o,setNotification:d,roles:c}=C(),[m,u]=(0,n.useState)({username:"",email:"",password:"",role:"user",is_active:!0}),x=async()=>{if(!m.username||!m.email||!m.password){d({type:"error",message:"Please fill in all required fields"});return}o(!0);try{let e=await N(m);i([...r,e]),d({type:"success",message:"User ".concat(e.username," created successfully")}),t(!1),u({username:"",email:"",password:"",role:"user",is_active:!0}),setTimeout(()=>d(null),3e3)}catch(e){console.error("Error adding user:",e),d({type:"error",message:e.message||"Failed to create user"}),setTimeout(()=>d(null),3e3)}finally{o(!1)}};return(0,a.jsx)(R,{open:s,onOpenChange:t,children:(0,a.jsxs)(O,{className:"bg-card border border-border text-card-foreground",children:[(0,a.jsx)(P,{children:(0,a.jsx)(L,{children:"Add New User"})}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(q,{htmlFor:"username",children:["Username ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsx)($.p,{id:"username",value:m.username,onChange:e=>u({...m,username:e.target.value}),className:"bg-background border-input text-foreground",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(q,{htmlFor:"email",children:["Email ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsx)($.p,{id:"email",type:"email",value:m.email,onChange:e=>u({...m,email:e.target.value}),className:"bg-background border-input text-foreground",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(q,{htmlFor:"password",children:["Password ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsx)($.p,{id:"password",type:"password",value:m.password,onChange:e=>u({...m,password:e.target.value}),className:"bg-background border-input text-foreground",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q,{htmlFor:"role",children:"Role"}),(0,a.jsxs)(H,{value:m.role,onValueChange:e=>u({...m,role:e}),children:[(0,a.jsx)(Q,{className:"bg-background border-input text-foreground",children:(0,a.jsx)(K,{placeholder:"Select a role"})}),(0,a.jsx)(es,{className:"bg-popover border border-border text-popover-foreground",children:c.map(e=>(0,a.jsx)(et,{value:e.name,children:e.name},e.id))})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(V,{id:"is_active",checked:m.is_active,onCheckedChange:e=>u({...m,is_active:e})}),(0,a.jsx)(q,{htmlFor:"is_active",children:"Active"})]})]}),(0,a.jsxs)(z,{children:[(0,a.jsx)(_.$,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),(0,a.jsx)(_.$,{className:"bg-violet-600 hover:bg-violet-700 text-white btn-glow",onClick:x,disabled:l,children:l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(E.A,{className:"h-3 w-3 mr-1 animate-spin text-white"}),"Creating..."]}):"Add User"})]})]})})}function en(){let{users:e}=C(),[s,t]=(0,n.useState)(!1),[r,i]=(0,n.useState)(!1),[l,o]=(0,n.useState)(!1),[d,c]=(0,n.useState)(null),m=e=>{c(e),t(!0)},u=e=>{c(e),i(!0)};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"User Management"}),(0,a.jsxs)(_.$,{className:"bg-violet-600 hover:bg-violet-700 text-white btn-glow",onClick:()=>o(!0),children:[(0,a.jsx)(A.A,{className:"h-4 w-4 mr-2"}),"Add User"]})]}),(0,a.jsx)("div",{className:"bg-card p-4 rounded-lg border border-border overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-left",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-border",children:[(0,a.jsx)("th",{className:"p-3 text-muted-foreground",children:"ID"}),(0,a.jsx)("th",{className:"p-3 text-muted-foreground",children:"Username"}),(0,a.jsx)("th",{className:"p-3 text-muted-foreground",children:"Email"}),(0,a.jsx)("th",{className:"p-3 text-muted-foreground",children:"Role"}),(0,a.jsx)("th",{className:"p-3 text-muted-foreground",children:"Status"}),(0,a.jsx)("th",{className:"p-3 text-muted-foreground",children:"Created"}),(0,a.jsx)("th",{className:"p-3 text-muted-foreground",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:null==e?void 0:e.map(e=>(0,a.jsxs)("tr",{className:"border-b border-border hover:bg-accent/50",children:[(0,a.jsx)("td",{className:"p-3 text-card-foreground",children:e.id}),(0,a.jsx)("td",{className:"p-3 text-card-foreground",children:e.username}),(0,a.jsx)("td",{className:"p-3 text-card-foreground",children:e.email}),(0,a.jsx)("td",{className:"p-3",children:(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("admin"===e.role?"bg-purple-500 text-white":"researcher"===e.role?"bg-blue-500 text-white":"bg-gray-500 text-white"),children:e.role})}),(0,a.jsx)("td",{className:"p-3",children:(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat(e.is_active?"bg-green-500 text-white":"bg-red-500 text-white"),children:e.is_active?"Active":"Inactive"})}),(0,a.jsx)("td",{className:"p-3 text-muted-foreground",children:new Date(e.created_at).toLocaleDateString()}),(0,a.jsx)("td",{className:"p-3",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(_.$,{variant:"outline",size:"sm",className:"border-violet-600 text-violet-600 hover:bg-violet-600/20 text-xs h-7",onClick:()=>m(e),children:"Edit"}),"admin"!==e.username&&(0,a.jsx)(_.$,{variant:"outline",size:"sm",className:"text-xs h-7 border-destructive text-destructive hover:bg-destructive/20",onClick:()=>u(e),children:"Delete"})]})})]},e.id))})]})}),s&&(0,a.jsx)(ea,{open:s,onOpenChange:t,user:d}),r&&(0,a.jsx)(er,{open:r,onOpenChange:i,user:d}),(0,a.jsx)(ei,{open:l,onOpenChange:o})]})}et.displayName=Y.q7.displayName,n.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(Y.wv,{ref:s,className:(0,D.cn)("-mx-1 my-1 h-px bg-muted",t),...r})}).displayName=Y.wv.displayName;var el=t(9993);function eo(e){let s=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!e)return"N/A";try{let t="string"==typeof e?new Date(e):e;if(isNaN(t.getTime()))return"Invalid date";let a={year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"};return s&&(a.second="2-digit"),t.toLocaleString("en-US",a)}catch(e){return console.error("Error formatting date:",e),"Error formatting date"}}function ed(){let{activity:e,setActivity:s,isProcessing:t,setIsProcessing:r,setNotification:i}=C(),[l,o]=(0,n.useState)(!1),[d,c]=(0,n.useState)(new Date);(0,n.useEffect)(()=>{if(!l)return;let e=setInterval(()=>{m(!1),c(new Date)},1e4);return()=>clearInterval(e)},[l]);let m=async function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];e&&r(!0);try{let t=await p();s(t.activity),e&&(i({type:"success",message:"Activity logs refreshed successfully"}),setTimeout(()=>i(null),3e3))}catch(s){console.error("Error refreshing activity logs:",s),e&&i({type:"error",message:"Failed to refresh activity logs"})}finally{e&&r(!1)}},u=async()=>{if(confirm("Are you sure you want to clear old activity logs? This cannot be undone.")){r(!0);try{await w(30),i({type:"success",message:"Activity logs older than 30 days have been cleared"});let e=await p();s(e.activity)}catch(e){console.error("Error clearing logs:",e),i({type:"error",message:"Failed to clear activity logs"})}finally{r(!1)}}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"Activity Log"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)("div",{className:"flex items-center mr-4",children:[(0,a.jsx)("input",{type:"checkbox",id:"auto-refresh",checked:l,onChange:e=>o(e.target.checked),className:"mr-2"}),(0,a.jsx)("label",{htmlFor:"auto-refresh",className:"text-sm text-muted-foreground",children:"Auto-refresh"})]}),(0,a.jsxs)(_.$,{variant:"outline",className:"border-violet-600 text-violet-600 hover:bg-violet-600/20",onClick:()=>m(),disabled:t,children:[(0,a.jsx)(E.A,{className:"h-4 w-4 mr-2 ".concat(t?"animate-spin":"")}),"Refresh"]}),(0,a.jsxs)(_.$,{variant:"outline",className:"border-destructive text-destructive hover:bg-destructive/20",onClick:u,disabled:t,children:[(0,a.jsx)(el.A,{className:"h-4 w-4 mr-2"}),"Clear Old Logs"]})]})]}),l&&(0,a.jsxs)("div",{className:"text-xs text-muted-foreground text-right",children:["Last refreshed: ",eo(d)," (auto-refreshes every 10 seconds)"]}),(0,a.jsx)("div",{className:"bg-card p-4 rounded-lg border border-border",children:0===e.length?(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No activity logs found"}):(0,a.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,a.jsxs)("div",{className:"p-3 border-b border-border last:border-0",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("div",{className:"text-card-foreground font-medium",children:e.action}),(0,a.jsxs)("div",{className:"text-muted-foreground text-sm flex items-center gap-2",children:[(0,a.jsx)("span",{children:eo(e.timestamp)}),(0,a.jsxs)("span",{className:"text-xs opacity-70",children:["(",function(e){if(!e)return"N/A";try{let s="string"==typeof e?new Date(e):e;if(isNaN(s.getTime()))return"Invalid date";let t=new Date,a=Math.floor((t.getTime()-s.getTime())/1e3);if(a<60)return"".concat(a," second").concat(1!==a?"s":""," ago");let r=Math.floor(a/60);if(r<60)return"".concat(r," minute").concat(1!==r?"s":""," ago");let i=Math.floor(r/60);if(i<24)return"".concat(i," hour").concat(1!==i?"s":""," ago");let n=Math.floor(i/24);if(n<30)return"".concat(n," day").concat(1!==n?"s":""," ago");let l=Math.floor(n/30);if(l<12)return"".concat(l," month").concat(1!==l?"s":""," ago");let o=Math.floor(l/12);return"".concat(o," year").concat(1!==o?"s":""," ago")}catch(e){return console.error("Error calculating relative time:",e),"Error calculating time"}}(e.timestamp),")"]})]})]}),(0,a.jsxs)("div",{className:"text-muted-foreground mt-1",children:["User: ",e.username]}),e.details&&(0,a.jsx)("div",{className:"text-muted-foreground text-sm mt-1",children:e.details}),e.ip_address&&(0,a.jsxs)("div",{className:"text-muted-foreground text-xs mt-1",children:["IP: ",e.ip_address]})]},e.id))})}),e.length>0&&(0,a.jsxs)("div",{className:"text-center text-muted-foreground text-sm",children:["Showing ",e.length," most recent activities"]})]})}var ec=t(6352);let em=n.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(ec.bL,{ref:s,className:(0,D.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...r,children:(0,a.jsx)(ec.C1,{className:(0,D.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(G.A,{className:"h-4 w-4"})})})});function eu(e){let{open:s,onOpenChange:t,role:r}=e,{roles:i,setRoles:l,availablePermissions:o,isProcessing:d,setIsProcessing:c,setNotification:m}=C(),[u,x]=(0,n.useState)({id:r.id,name:r.name,description:r.description,permissions:[...r.permissions]}),h=e=>{x(s=>{let t=s.permissions.includes(e)?s.permissions.filter(s=>s!==e):[...s.permissions,e];return{...s,permissions:t}})},p=async()=>{if(!u.name){m({type:"error",message:"Role name is required"});return}c(!0);try{let e=i.map(e=>e.id===u.id?u:e);l(e),m({type:"success",message:'Role "'.concat(u.name,'" updated successfully')}),t(!1),setTimeout(()=>m(null),3e3)}catch(e){console.error("Error updating role:",e),m({type:"error",message:"Failed to update role"}),setTimeout(()=>m(null),3e3)}finally{c(!1)}};return(0,a.jsx)(R,{open:s,onOpenChange:t,children:(0,a.jsxs)(O,{className:"bg-card border border-border text-card-foreground",children:[(0,a.jsx)(P,{children:(0,a.jsx)(L,{children:"Edit Role"})}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(q,{htmlFor:"name",children:["Role Name ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsx)($.p,{id:"name",value:u.name,onChange:e=>x({...u,name:e.target.value}),className:"bg-background border-input text-foreground",disabled:"admin"===u.name||"researcher"===u.name||"user"===u.name,required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q,{htmlFor:"description",children:"Description"}),(0,a.jsx)($.p,{id:"description",value:u.description,onChange:e=>x({...u,description:e.target.value}),className:"bg-background border-input text-foreground",placeholder:"Role description"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q,{children:"Permissions"}),(0,a.jsx)("div",{className:"space-y-2 border border-border rounded-md p-4 max-h-48 overflow-y-auto",children:o.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(em,{id:"permission-".concat(e.id),checked:u.permissions.includes(e.id),onCheckedChange:()=>h(e.id),disabled:"admin"===u.name&&"user_management"===e.id}),(0,a.jsx)(q,{htmlFor:"permission-".concat(e.id),className:"font-normal cursor-pointer",children:e.name})]},e.id))})]})]}),(0,a.jsxs)(z,{children:[(0,a.jsx)(_.$,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),(0,a.jsx)(_.$,{className:"bg-violet-600 hover:bg-violet-700 text-white btn-glow",onClick:p,disabled:d,children:d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(E.A,{className:"h-3 w-3 mr-1 animate-spin text-white"}),"Saving..."]}):"Save Changes"})]})]})})}function ex(e){let{open:s,onOpenChange:t}=e,{roles:r,setRoles:i,availablePermissions:l,isProcessing:o,setIsProcessing:d,setNotification:c}=C(),[m,u]=(0,n.useState)({name:"",description:"",permissions:[]}),x=e=>{u(s=>{let t=s.permissions.includes(e)?s.permissions.filter(s=>s!==e):[...s.permissions,e];return{...s,permissions:t}})},h=async()=>{if(!m.name){c({type:"error",message:"Role name is required"});return}d(!0);try{let e={id:r.length+1,...m};i([...r,e]),c({type:"success",message:'Role "'.concat(m.name,'" created successfully')}),t(!1),u({name:"",description:"",permissions:[]}),setTimeout(()=>c(null),3e3)}catch(e){console.error("Error adding role:",e),c({type:"error",message:"Failed to create role"}),setTimeout(()=>c(null),3e3)}finally{d(!1)}};return(0,a.jsx)(R,{open:s,onOpenChange:t,children:(0,a.jsxs)(O,{className:"bg-card border border-border text-card-foreground",children:[(0,a.jsx)(P,{children:(0,a.jsx)(L,{children:"Add New Role"})}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(q,{htmlFor:"name",children:["Role Name ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsx)($.p,{id:"name",value:m.name,onChange:e=>u({...m,name:e.target.value}),className:"bg-background border-input text-foreground",placeholder:"e.g., editor",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q,{htmlFor:"description",children:"Description"}),(0,a.jsx)($.p,{id:"description",value:m.description,onChange:e=>u({...m,description:e.target.value}),className:"bg-background border-input text-foreground",placeholder:"Role description"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q,{children:"Permissions"}),(0,a.jsx)("div",{className:"space-y-2 border border-border rounded-md p-4 max-h-48 overflow-y-auto",children:l.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(em,{id:"permission-".concat(e.id),checked:m.permissions.includes(e.id),onCheckedChange:()=>x(e.id)}),(0,a.jsx)(q,{htmlFor:"permission-".concat(e.id),className:"font-normal cursor-pointer",children:e.name})]},e.id))})]})]}),(0,a.jsxs)(z,{children:[(0,a.jsx)(_.$,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),(0,a.jsx)(_.$,{className:"bg-violet-600 hover:bg-violet-700 text-white btn-glow",onClick:h,disabled:o,children:o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(E.A,{className:"h-3 w-3 mr-1 animate-spin text-white"}),"Creating..."]}):"Add Role"})]})]})})}function eh(){let{roles:e,availablePermissions:s}=C(),[t,r]=(0,n.useState)(!1),[i,l]=(0,n.useState)(!1),[o,d]=(0,n.useState)(null),c=e=>{d(e),r(!0)};return(0,n.useEffect)(()=>{},[e]),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"Role Management"}),(0,a.jsxs)(_.$,{className:"bg-violet-600 hover:bg-violet-700 text-white btn-glow",onClick:()=>l(!0),children:[(0,a.jsx)(A.A,{className:"h-4 w-4 mr-2"}),"Add Role"]})]}),(0,a.jsx)("p",{className:"text-muted-foreground mb-6",children:"Configure role-based permissions and access controls for your application."}),(0,a.jsx)("div",{className:"bg-card p-6 rounded-lg border border-border",children:(0,a.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,a.jsx)("div",{className:"p-4 border border-border rounded-lg",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-card-foreground font-medium mb-2",children:e.name}),(0,a.jsx)("p",{className:"text-muted-foreground text-sm mb-2",children:e.description}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:e.permissions.map(e=>{var t;return(0,a.jsx)("span",{className:"px-2 py-1 bg-accent rounded-md text-xs text-foreground",children:(null===(t=s.find(s=>s.id===e))||void 0===t?void 0:t.name)||e},e)})})]}),(0,a.jsx)(_.$,{variant:"outline",size:"sm",className:"border-violet-600 text-violet-600 hover:bg-violet-600/20 text-xs h-7",onClick:()=>c(e),children:"Edit Role"})]})},e.id))})}),t&&(0,a.jsx)(eu,{open:t,onOpenChange:r,role:o}),(0,a.jsx)(ex,{open:i,onOpenChange:l})]})}function ep(){let{systemSettings:e,setSystemSettings:s,isProcessing:t,setIsProcessing:r,setNotification:i}=C(),n=async(e,t)=>{r(!0);try{let a=await g(e,t);s(a),i({type:"success",message:"".concat(e.replace(/_/g," ")," has been ").concat(t?"enabled":"disabled")}),setTimeout(()=>i(null),3e3)}catch(e){console.error("Error updating setting:",e),i({type:"error",message:"Failed to update setting"}),setTimeout(()=>i(null),3e3)}finally{r(!1)}},l=async()=>{r(!0);try{await f(),i({type:"success",message:"Backup process started"}),setTimeout(()=>{i(null)},3e3)}catch(e){console.error("Error starting backup:",e),i({type:"error",message:"Failed to start backup"}),setTimeout(()=>i(null),3e3)}finally{r(!1)}},o=async()=>{r(!0);try{await b(),i({type:"success",message:"Data export initiated"}),setTimeout(()=>i(null),3e3)}catch(e){console.error("Error exporting data:",e),i({type:"error",message:"Failed to export data"}),setTimeout(()=>i(null),3e3)}finally{r(!1)}},d=async()=>{r(!0);try{await j(),i({type:"success",message:"Data cleanup process started"}),setTimeout(()=>i(null),3e3)}catch(e){console.error("Error cleaning up data:",e),i({type:"error",message:"Failed to clean up data"}),setTimeout(()=>i(null),3e3)}finally{r(!1)}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-foreground mb-4",children:"Settings"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-card p-6 rounded-lg border border-border",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-card-foreground mb-4",children:"System Settings"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 border-b border-border",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-card-foreground font-medium",children:"Maintenance Mode"}),(0,a.jsx)("p",{className:"text-muted-foreground text-xs",children:"Temporarily disable access to the application"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(V,{id:"maintenance-mode",checked:(null==e?void 0:e.maintenance_mode)||!1,onCheckedChange:e=>n("maintenance_mode",e),disabled:t}),(0,a.jsx)(q,{htmlFor:"maintenance-mode",className:"sr-only",children:"Maintenance Mode"})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 border-b border-border",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-card-foreground font-medium",children:"Debug Mode"}),(0,a.jsx)("p",{className:"text-muted-foreground text-xs",children:"Enable detailed error messages and logging"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(V,{id:"debug-mode",checked:(null==e?void 0:e.debug_mode)||!1,onCheckedChange:e=>n("debug_mode",e),disabled:t}),(0,a.jsx)(q,{htmlFor:"debug-mode",className:"sr-only",children:"Debug Mode"})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 border-b border-border",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-card-foreground font-medium",children:"API Rate Limiting"}),(0,a.jsx)("p",{className:"text-muted-foreground text-xs",children:"Limit API requests per user"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(V,{id:"api-rate-limiting",checked:(null==e?void 0:e.api_rate_limiting)||!1,onCheckedChange:e=>n("api_rate_limiting",e),disabled:t}),(0,a.jsx)(q,{htmlFor:"api-rate-limiting",className:"sr-only",children:"API Rate Limiting"})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-card p-6 rounded-lg border border-border",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-card-foreground mb-4",children:"Data Management"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"p-3 border-b border-border",children:[(0,a.jsx)("h4",{className:"text-card-foreground font-medium mb-2",children:"Database Backup"}),(0,a.jsxs)("p",{className:"text-muted-foreground text-xs mb-3",children:["Last backup:"," ",(null==e?void 0:e.last_backup)?new Date(e.last_backup).toLocaleString():"Never"]}),(0,a.jsx)(_.$,{className:"bg-violet-600 hover:bg-violet-700 text-white btn-glow text-xs py-1 h-8",onClick:l,disabled:t,children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(E.A,{className:"h-3 w-3 mr-1 animate-spin text-white"}),"Running..."]}):"Run Backup Now"})]}),(0,a.jsxs)("div",{className:"p-3 border-b border-border",children:[(0,a.jsx)("h4",{className:"text-card-foreground font-medium mb-2",children:"Data Export"}),(0,a.jsx)("p",{className:"text-muted-foreground text-xs mb-3",children:"Export system data for backup or migration"}),(0,a.jsx)(_.$,{className:"bg-violet-600 hover:bg-violet-700 text-white btn-glow text-xs py-1 h-8",onClick:o,disabled:t,children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(E.A,{className:"h-3 w-3 mr-1 animate-spin text-white"}),"Exporting..."]}):"Export Data"})]}),(0,a.jsxs)("div",{className:"p-3 border-b border-border",children:[(0,a.jsx)("h4",{className:"text-card-foreground font-medium mb-2",children:"Data Cleanup"}),(0,a.jsx)("p",{className:"text-muted-foreground text-xs mb-3",children:"Remove old or unused data from the system"}),(0,a.jsx)(_.$,{className:"bg-violet-600 hover:bg-violet-700 text-white btn-glow text-xs py-1 h-8",onClick:d,disabled:t,children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(E.A,{className:"h-3 w-3 mr-1 animate-spin text-white"}),"Cleaning..."]}):"Cleanup Data"})]})]})]})]})]})}function eg(e){let{activeTab:s,loading:t,error:r}=e;return t?(0,a.jsx)("div",{className:"flex justify-center py-12",children:(0,a.jsx)(k.A,{})}):(0,a.jsxs)(a.Fragment,{children:[r&&(0,a.jsx)("div",{className:"bg-yellow-500/20 border border-yellow-500 text-yellow-700 dark:text-yellow-200 px-4 py-2 rounded-md mb-4",children:(0,a.jsx)("p",{children:r})}),"dashboard"===s&&(0,a.jsx)(S,{}),"users"===s&&(0,a.jsx)(en,{}),"activity"===s&&(0,a.jsx)(ed,{}),"permissions"===s&&(0,a.jsx)(eh,{}),"settings"===s&&(0,a.jsx)(ep,{})]})}em.displayName=ec.bL.displayName;var ef=t(3239),eb=t(1594);function ej(e){let{notification:s}=e;return(0,a.jsxs)("div",{className:"mb-4 p-3 rounded-md flex items-center ".concat("success"===s.type?"bg-violet-500/20 border border-violet-500 text-violet-700 dark:text-violet-200":"bg-red-500/20 border border-red-500 text-red-700 dark:text-red-200"),children:["success"===s.type?(0,a.jsx)(ef.A,{className:"h-5 w-5 mr-2 text-violet-500"}):(0,a.jsx)(eb.A,{className:"h-5 w-5 mr-2"}),(0,a.jsx)("p",{children:s.message})]})}function ev(){let{user:e}=(0,x.A)();!function(){let{logout:e}=(0,x.A)();(0,h.useRouter)()}();let[s,t]=(0,n.useState)("dashboard"),{loading:r,setLoading:i,error:g,setError:f,notification:b,setNotification:j,stats:v,setStats:y,users:N,setUsers:w,activity:k,setActivity:S,systemSettings:A,setSystemSettings:_}=C();(0,n.useEffect)(()=>{(async()=>{i(!0);try{let e=await p();y(e.stats),w(e.users),S(e.activity),_(e.systemSettings),f(null)}catch(e){console.error("Error fetching admin data:",e),f("Failed to load admin data. Using mock data instead.")}finally{i(!1)}})()},[]);let E=[{id:"dashboard",label:"Dashboard",icon:o.A},{id:"users",label:"Users",icon:d.A},{id:"activity",label:"Activity Log",icon:c.A},{id:"permissions",label:"Permissions",icon:m.A},{id:"settings",label:"Settings",icon:u.A}];return(0,a.jsxs)("div",{className:"container mx-auto px-6 py-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,a.jsx)(l.P.h1,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600",children:"Admin Dashboard"}),(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("div",{className:"px-4 py-2 bg-card backdrop-blur-sm rounded-lg border border-border",children:(0,a.jsxs)("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600 font-bold",children:["Welcome, ",null==e?void 0:e.username]})})})]}),b&&(0,a.jsx)(ej,{notification:b}),(0,a.jsxs)("div",{className:"bg-card backdrop-blur-sm rounded-lg border border-border overflow-hidden",children:[(0,a.jsx)("div",{className:"flex border-b border-border overflow-x-auto",children:E.map(e=>(0,a.jsxs)("button",{className:"flex items-center space-x-2 px-6 py-4 text-sm font-medium transition-colors whitespace-nowrap ".concat(s===e.id?"text-primary-foreground bg-primary border-b-2 border-primary":"text-muted-foreground hover:text-foreground hover:bg-accent"),onClick:()=>t(e.id),children:[(0,a.jsx)(e.icon,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:e.label})]},e.id))}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(eg,{activeTab:s,loading:r,error:g})})]})]})}var ey=t(3726);function eN(){return(0,a.jsx)(ey.A,{requiredRole:"admin",children:(0,a.jsxs)("main",{className:"min-h-screen bg-background antialiased relative overflow-hidden",children:[(0,a.jsx)("div",{className:"h-full w-full absolute inset-0 z-0",children:(0,a.jsx)(r.n,{id:"tsparticlesfullpage",background:"transparent",minSize:.6,maxSize:1.4,particleDensity:100,className:"w-full h-full",particleColor:"var(--foreground)"})}),(0,a.jsxs)("div",{className:"relative z-10",children:[(0,a.jsx)(i.A,{}),(0,a.jsx)(ev,{})]})]})})}},5472:(e,s,t)=>{"use strict";t.d(s,{A:()=>i});var a=t(5155),r=t(8888);function i(){return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,a.jsx)(r.P.div,{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full shadow-[0_0_15px_rgba(124,58,237,0.3)]",animate:{rotate:360},transition:{duration:1,repeat:Number.POSITIVE_INFINITY,ease:"linear"}}),(0,a.jsx)("p",{className:"mt-4 text-foreground",children:"Loading data..."})]})}},3726:(e,s,t)=>{"use strict";t.d(s,{A:()=>o});var a=t(5155),r=t(1069),i=t(6046),n=t(2115),l=t(5472);function o(e){let{children:s,requiredRole:t}=e,{user:o,isLoading:d}=(0,r.A)(),c=(0,i.useRouter)(),m=(0,i.usePathname)();return((0,n.useEffect)(()=>{let e="true"===sessionStorage.getItem("isLoggingOut");d||o?!d&&o&&t&&("admin"===t&&"admin"!==o.role||"researcher"===t&&!["admin","researcher"].includes(o.role))&&c.push("/"):e?(sessionStorage.removeItem("isLoggingOut"),c.push("/")):c.push("/login?redirect=".concat(encodeURIComponent(m)))},[o,d,c,m,t]),d)?(0,a.jsx)("div",{className:"min-h-screen bg-black/[0.96] flex items-center justify-center",children:(0,a.jsx)(l.A,{})}):t&&o&&("admin"===t&&"admin"!==o.role||"researcher"===t&&!["admin","researcher"].includes(o.role))||!o?null:(0,a.jsx)(a.Fragment,{children:s})}},2336:(e,s,t)=>{"use strict";t.d(s,{p:()=>n});var a=t(5155),r=t(2115),i=t(9602);let n=r.forwardRef((e,s)=>{let{className:t,type:r,...n}=e;return(0,a.jsx)("input",{type:r,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...n})});n.displayName="Input"}},e=>{var s=s=>e(e.s=s);e.O(0,[489,565,182,786,441,517,358],()=>s(8126)),_N_E=e.O()}]);